# weblogic unserialize exploit

**java反序列化漏洞的weblogic exploit命令回显exp**

![index](exploit.png)

### 1.依赖组件
+ python 2.7
+ java

### 2. 程序说明
+ exploit方法来源于Freebuf的”Java反序列化漏洞之weblogic本地利用实现篇”，基于rebeyond大牛的研究和反编译WebLogic_EXP.jar实现的。

+ 与rebeyond的方法相比，只提取了WebLogic_EXP.jar中用到的少数几个java class，使用python脚本来实现exploit。

### 3.使用说明 
+ ./weblogic.py [host] [port] [win | linux] [verify | exploit]
 
		host:weblogic服务器地址
 	 	port:端口
 	 	win|linux:指定weblogic操作系统类型,windows或linux
 	 	verify|exploit:verify通过执行一次whoami命令进行检查;exploit可以模拟shell操作远程执行命令，如果命令行有空格，请使用"，如果"net user"

+ 远程执行命令是通过java的RMI来实现的，调用命令是
	
		java -classpath .;weblogic.jar;javax.jar shellApp [host] [port] [cmd]（在windows下）。
		java -classpath .:weblogic.jar:javax.jar shellApp [host] [port] [cmd] （在linux/mac下）。
		
		注意：classpath的分隔符，在windows下是“;",而在linux/mac下是":"

+ 程序在windows/linux/mac下测试通过，weblogic版本为10.3.6，其余版本尚未测试。

### 4.payload_bin说明

+ payload_bin下面的各种payload是用于向weblogic通过t3协议发送的反序列化内容，由通过执行genPayload.class产生的，执行命令为：
	
		java -classpath .;collections_3.2.0.jar genPayload [win|linux] [payload_type](windows下)
		java -classpath .:collections_3.2.0.jar genPayload [win|linux] [payload_type](linux/mac下)
		
		Payload_Type:upload_inst|inst|upload_uninst|uninst|delete

### 5.未完部份...

+ 文件上传功能

+ 将java的class打包为jar
	
+ 增加批量检测及检测结果格式化输出

+ exploit的稳定性

+ ......
	

### 6.其它

+ 本程序只用于技术研究和个人使用，来源于网络、分享于网络，欢迎各位大牛继续完善

+ hancool@163.com 2015.12.24
